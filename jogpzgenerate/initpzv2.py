import re
from datetime import datetime


def parse_log_data(log_text):
    lines = log_text.strip().split('\n')
    joint_targets = []

    for line in lines:
        # 使用正则表达式分割列（处理制表符和多个空格）
        columns = re.split(r'\t|\s{2,}', line.strip())
        if len(columns) < 5:
            continue

        title = columns[4]  # 标题列

        # 检查标题是否包含轴位置数据
        if not title.startswith('P:'):
            continue

        # 提取数值部分
        values_part = title[2:].strip()

        # 分割数值
        values = values_part.split()

        # 检查是否有足够的数值（6个轴位置）
        if len(values) >= 6:
            try:
                # 尝试将前6个值转换为浮点数
                axis_values = [float(val) for val in values[:6]]

                # 格式化日期
                date_str = columns[5] if len(columns) > 5 else ""

                # 添加到结果列表
                joint_targets.append({
                    'values': axis_values,
                    'date': date_str
                })
            except ValueError:
                # 如果转换失败，跳过这一行
                continue

    return joint_targets


def classify_jointtargets(joint_targets):
    # 定义8种分类
    categories = {
        '第四轴正_第五轴正_第六轴正': [],
        '第四轴正_第五轴正_第六轴负': [],
        '第四轴正_第五轴负_第六轴正': [],
        '第四轴正_第五轴负_第六轴负': [],
        '第四轴负_第五轴正_第六轴正': [],
        '第四轴负_第五轴正_第六轴负': [],
        '第四轴负_第五轴负_第六轴正': [],
        '第四轴负_第五轴负_第六轴负': []
    }

    for target in joint_targets:
        values = target['values']
        # 获取第四、五、六轴的值
        axis4 = values[3]
        axis5 = values[4]
        axis6 = values[5]

        # 确定每个轴的正负
        axis4_sign = "正" if axis4 >= 0 else "负"
        axis5_sign = "正" if axis5 >= 0 else "负"
        axis6_sign = "正" if axis6 >= 0 else "负"

        # 构建分类键
        category_key = f"第四轴{axis4_sign}_第五轴{axis5_sign}_第六轴{axis6_sign}"

        # 添加到对应分类
        if category_key in categories:
            categories[category_key].append(target)
        else:
            # 如果分类不存在（理论上不会发生），添加到默认分类
            categories.setdefault('其他', []).append(target)

    return categories


def format_jointtargets(joint_targets, base_name="JT_Set1"):
    formatted = []

    for i, target in enumerate(joint_targets, 1):
        values = target['values']
        # 格式化数值，保留4位小数
        formatted_values = [f"{v:.4f}" for v in values]

        # 创建CONST jointtarget字符串
        jt_str = f"CONST jointtarget {base_name}_{i}:=[[{','.join(formatted_values)}],[0,9000000000.0,9000000000.0,0,0,0]];"

        formatted.append(jt_str)

    return formatted


# 示例使用
if __name__ == "__main__":
    # 这里是你的日志数据
    log_data = """95        	警       	用户                  	80002   	P: 50.14958 4.18733 21.84866 40.439 -23.257 -114.957	2025-09-19 15:37:41 	ABSACC
108       	警       	用户                  	80002   	P: 50.14720 4.19079 21.85421 40.438 -23.258 -114.958	2025-09-19 15:38:31 	ABSACC
109       	警       	用户                  	80002   	P: 17.23447 36.91549 5.76012 -29.456 -38.444 -57.565	2025-09-19 15:38:32 	ABSACC
110       	警       	用户                  	80002   	P: 46.88413 27.29994 13.42701 20.709 -34.668 -94.630	2025-09-19 15:38:33 	ABSACC
111       	警       	用户                  	80002   	P: 33.27718 38.25245 2.70760 -3.483 -33.351 -76.301	2025-09-19 15:38:34 	ABSACC
112       	警       	用户                  	80002   	P: 49.85834 15.09684 33.04740 21.883 -42.354 -93.477	2025-09-19 15:38:35 	ABSACC
113       	警       	用户                  	80002   	P: 42.47588 28.70247 -3.59343 22.945 -18.776 -99.805	2025-09-19 15:38:36 	ABSACC
114       	警       	用户                  	80002   	P: 40.74226 22.20663 12.86974 11.833 -27.881 -88.692	2025-09-19 15:38:36 	ABSACC
115       	警       	用户                  	80002   	P: -35.08620 27.70877 3.82836 -86.250 -69.229 -19.838	2025-09-19 15:38:39 	ABSACC
116       	警       	用户                  	80002   	P: 49.37858 11.24066 6.25345 56.382 -16.983 -132.196	2025-09-19 15:38:42 	ABSACC
117       	警       	用户                  	80002   	P: 39.65279 10.44811 43.46050 6.133 -46.393 -82.591	2025-09-19 15:38:43 	ABSACC
118       	警       	用户                  	80002   	P: 24.88326 14.67366 6.26461 -38.424 -16.600 -43.085	2025-09-19 15:38:44 	ABSACC
119       	警       	用户                  	80002   	P: -48.66204 4.34089 25.47856 -93.662 -80.894 -18.061	2025-09-19 15:38:46 	ABSACC
120       	警       	用户                  	80002   	P: 26.85630 3.96941 20.48830 -26.744 -18.595 -54.531	2025-09-19 15:38:48 	ABSACC
121       	警       	用户                  	80002   	P: -30.90703 21.78151 13.69629 -82.184 -66.161 -24.466	2025-09-19 15:38:50 	ABSACC
122       	警       	用户                  	80002   	P: -40.61711 17.25878 23.26369 -86.637 -74.267 -28.986	2025-09-19 15:38:50 	ABSACC
123       	警       	用户                  	80002   	P: 56.69027 13.57144 -1.88361 81.219 -21.596 -156.505	2025-09-19 15:38:53 	ABSACC
124       	警       	用户                  	80002   	P: -23.40993 37.88054 6.23931 -72.666 -62.410 -35.221	2025-09-19 15:38:56 	ABSACC
125       	警       	用户                  	80002   	P: -33.52395 20.23835 -1.98927 -90.870 -67.475 -5.568	2025-09-19 15:38:57 	ABSACC
126       	警       	用户                  	80002   	P: 21.44137 28.37939 10.41041 -25.215 -33.512 -59.370	2025-09-19 15:38:59 	ABSACC
127       	警       	用户                  	80002   	P: 41.42723 29.03961 -4.35533 20.422 -18.032 -97.591	2025-09-19 15:39:00 	ABSACC
128       	警       	用户                  	80002   	P: 33.63544 37.56807 -1.01557 -3.220 -28.945 -76.332	2025-09-19 15:39:01 	ABSACC
129       	警       	用户                  	80002   	P: 25.69362 19.44239 6.13696 -28.507 -20.076 -53.191	2025-09-19 15:39:01 	ABSACC
130       	警       	用户                  	80002   	P: 40.17105 43.24024 -8.10394 10.631 -27.882 -87.705	2025-09-19 15:39:02 	ABSACC
131       	警       	用户                  	80002   	P: 45.50016 29.83377 -0.27700 25.960 -23.943 -101.553	2025-09-19 15:39:03 	ABSACC
132       	警       	用户                  	80002   	P: 20.95376 21.49255 16.83187 -26.429 -33.253 -58.314	2025-09-19 15:39:04 	ABSACC
133       	警       	用户                  	80002   	P: 19.57272 27.74886 22.07812 -22.543 -44.170 -64.492	2025-09-19 15:39:04 	ABSACC
134       	警       	用户                  	80002   	P: -30.02652 19.42213 21.41376 -79.261 -66.345 -30.346	2025-09-19 15:39:06 	ABSACC
135       	警       	用户                  	80002   	P: -34.18251 15.96180 6.11644 -89.543 -68.062 -9.692	2025-09-19 15:39:07 	ABSACC
136       	警       	用户                  	80002   	P: 47.65013 -2.75545 19.04790 56.157 -14.950 -132.496	2025-09-19 15:39:09 	ABSACC
137       	警       	用户                  	80002   	P: 21.01371 21.54998 20.22249 -24.172 -36.373 -61.010	2025-09-19 15:39:10 	ABSACC
138       	警       	用户                  	80002   	P: 30.54163 7.36031 23.69913 -11.443 -23.788 -69.070	2025-09-19 15:39:11 	ABSACC
139       	警       	用户                  	80002   	P: 20.07757 19.50799 13.67613 -32.110 -29.136 -52.289	2025-09-19 15:39:11 	ABSACC
140       	警       	用户                  	80002   	P: -39.70385 20.24031 -10.05750 -95.099 -73.895 2.602	2025-09-19 15:39:13 	ABSACC
141       	警       	用户                  	80002   	P: 25.10513 2.73419 33.96202 -20.001 -30.456 -62.882	2025-09-19 15:39:16 	ABSACC
142       	警       	用户                  	80002   	P: -41.97995 11.31821 17.18939 -90.732 -75.120 -16.489	2025-09-19 15:39:17 	ABSACC
143       	警       	用户                  	80002   	P: 46.36068 18.50062 10.76622 28.158 -24.051 -103.482	2025-09-19 15:39:20 	ABSACC
144       	警       	用户                  	80002   	P: 37.82787 14.11206 24.13037 5.111 -30.682 -82.989	2025-09-19 15:39:21 	ABSACC
145       	警       	用户                  	80002   	P: 39.53467 -12.93131 21.29493 -278.912 -4.366 200.576	2025-09-19 15:39:22 	ABSACC
146       	警       	用户                  	80002   	P: 43.34840 37.64870 -7.09337 20.121 -24.137 -96.339	2025-09-19 15:39:24 	ABSACC
147       	警       	用户                  	80002   	P: -39.32658 32.66867 11.19243 -84.787 -73.576 -32.542	2025-09-19 15:39:26 	ABSACC
148       	警       	用户                  	80002   	P: 40.42567 23.71128 23.50454 8.156 -39.820 -84.527	2025-09-19 15:39:29 	ABSACC
149       	警       	用户                  	80002   	P: 20.33933 7.25636 13.01313 -50.914 -19.142 -31.657	2025-09-19 15:39:30 	ABSACC
150       	警       	用户                  	80002   	P: 52.77588 37.96921 -5.74555 37.448 -29.530 -110.216	2025-09-19 15:39:31 	ABSACC
151       	警       	用户                  	80002   	P: 21.22214 16.65868 31.32638 -20.958 -42.045 -64.968	2025-09-19 15:39:33 	ABSACC
152       	警       	用户                  	80002   	P: -37.95887 5.34222 25.12902 -88.140 -71.649 -18.588	2025-09-19 15:39:35 	ABSACC
153       	警       	用户                  	80002   	P: 46.75299 30.85582 3.83927 24.184 -29.073 -98.808	2025-09-19 15:39:37 	ABSACC
154       	警       	用户                  	80002   	P: -42.29869 -0.56249 36.21087 -89.011 -75.411 -23.880	2025-09-19 15:39:40 	ABSACC
155       	警       	用户                  	80002   	P: 37.21787 38.23929 0.98067 3.881 -31.625 -81.971	2025-09-19 15:39:43 	ABSACC
156       	警       	用户                  	80002   	P: 27.80354 2.01992 20.21553 -27.204 -16.211 -53.670	2025-09-19 15:39:44 	ABSACC
157       	警       	用户                  	80002   	P: 24.17574 38.69916 -4.03736 -23.103 -28.852 -59.947	2025-09-19 15:39:45 	ABSACC
158       	警       	用户                  	80002   	P: -32.40549 38.48629 -3.02793 -83.131 -67.382 -24.262	2025-09-19 15:39:47 	ABSACC
159       	警       	用户                  	80002   	P: 37.44059 40.48740 0.85921 4.054 -33.763 -82.008	2025-09-19 15:39:49 	ABSACC
160       	警       	用户                  	80002   	P: 54.24823 11.03516 3.27467 -287.560 -19.845 212.285	2025-09-19 15:39:51 	ABSACC
161       	警       	用户                  	80002   	P: 22.01400 37.16528 -1.13503 -26.183 -30.829 -57.843	2025-09-19 15:39:52 	ABSACC
162       	警       	用户                  	80002   	P: 39.66023 28.35093 0.18451 12.307 -21.298 -89.830	2025-09-19 15:39:53 	ABSACC
163       	警       	用户                  	80002   	P: 32.88690 11.27442 23.82033 -4.940 -27.512 -74.874	2025-09-19 15:39:54 	ABSACC
164       	警       	用户                  	80002   	P: 21.53380 17.96181 1.99034 -49.036 -18.058 -33.210	2025-09-19 15:39:55 	ABSACC
165       	警       	用户                  	80002   	P: -32.86284 12.66210 24.27183 -82.816 -67.919 -25.808	2025-09-19 15:39:56 	ABSACC
166       	警       	用户                  	80002   	P: 33.20063 35.46739 2.22388 -3.883 -30.105 -75.854	2025-09-19 15:39:59 	ABSACC
167       	警       	用户                  	80002   	P: 51.70869 30.22608 14.12575 26.374 -39.413 -97.627	2025-09-19 15:39:59 	ABSACC
168       	警       	用户                  	80002   	P: 32.64213 3.41680 41.76207 -4.142 -37.581 -76.000	2025-09-19 15:40:00 	ABSACC
169       	警       	用户                  	80002   	P: 19.06247 20.16178 0.32128 -52.941 -20.201 -29.978	2025-09-19 15:40:01 	ABSACC
170       	警       	用户                  	80002   	P: -49.53578 18.29098 34.81717 -90.438 -80.721 -41.662	2025-09-19 15:40:04 	ABSACC
171       	警       	用户                  	80002   	P: 31.12939 -16.89790 35.98429 -19.546 -12.069 -60.332	2025-09-19 15:40:06 	ABSACC
172       	警       	用户                  	80002   	P: 23.48449 -7.00654 20.58182 -63.950 -12.940 -17.166	2025-09-19 15:40:06 	ABSACC
173       	警       	用户                  	80002   	P: -26.90610 38.60184 -5.95272 -81.052 -62.484 -21.902	2025-09-19 15:40:08 	ABSACC
174       	警       	用户                  	80002   	P: 21.13976 34.20181 6.03481 -24.803 -34.901 -60.099	2025-09-19 15:40:10 	ABSACC
175       	警       	用户                  	80002   	P: -23.90005 28.28881 0.88095 -81.205 -59.395 -18.409	2025-09-19 15:40:12 	ABSACC
176       	警       	用户                  	80002   	P: -30.59398 3.51054 14.53406 -90.054 -64.674 -5.319	2025-09-19 15:40:13 	ABSACC
177       	警       	用户                  	80002   	P: 42.29786 -8.71932 31.80147 25.076 -16.872 -102.111	2025-09-19 15:40:15 	ABSACC
178       	警       	用户                  	80002   	P: 43.71994 13.69657 23.12515 16.987 -30.190 -92.582	2025-09-19 15:40:15 	ABSACC
179       	警       	用户                  	80002   	P: 29.18160 -1.87478 26.41579 -19.864 -17.838 -60.775	2025-09-19 15:40:16 	ABSACC
180       	警       	用户                  	80002   	P: 27.31037 39.70874 -0.16392 -14.599 -32.674 -67.632	2025-09-19 15:40:17 	ABSACC
181       	警       	用户                  	80002   	P: -50.47145 8.15677 23.27287 -94.325 -82.344 -19.796	2025-09-19 15:40:20 	ABSACC
182       	警       	用户                  	80002   	P: 47.70903 10.02548 24.89689 25.813 -29.591 -100.057	2025-09-19 15:40:22 	ABSACC
183       	警       	用户                  	80002   	P: -31.27874 12.25822 13.42773 -86.763 -65.528 -13.744	2025-09-19 15:40:25 	ABSACC
184       	警       	用户                  	80002   	P: -40.09340 20.92314 19.23052 -86.404 -73.845 -28.624	2025-09-19 15:40:25 	ABSACC
185       	警       	用户                  	80002   	P: 36.00784 42.19064 -7.24719 1.839 -27.314 -80.482	2025-09-19 15:40:28 	ABSACC
186       	警       	用户                  	80002   	P: 29.65658 18.31944 20.93009 -10.398 -31.974 -70.850	2025-09-19 15:40:29 	ABSACC
187       	警       	用户                  	80002   	P: 33.66683 22.71080 29.70815 -2.138 -44.786 -77.617	2025-09-19 15:40:29 	ABSACC
188       	警       	用户                  	80002   	P: 23.88614 29.44322 8.60405 -21.492 -32.064 -62.021	2025-09-19 15:40:30 	ABSACC
189       	警       	用户                  	80002   	P: -36.29494 -2.40411 26.01984 -89.768 -70.030 -11.352	2025-09-19 15:40:32 	ABSACC
190       	警       	用户                  	80002   	P: 43.72000 14.30076 20.75267 17.998 -28.511 -93.728	2025-09-19 15:40:34 	ABSACC
191       	警       	用户                  	80002   	P: 31.90030 19.67458 18.22752 -6.501 -30.393 -73.770	2025-09-19 15:40:35 	ABSACC
192       	警       	用户                  	80002   	P: 60.10390 24.76398 -1.25371 60.515 -28.680 -132.586	2025-09-19 15:40:36 	ABSACC
193       	警       	用户                  	80002   	P: 57.16327 29.23837 2.30788 -314.722 -31.466 -116.605	2025-09-19 15:40:38 	ABSACC
194       	警       	用户                  	80002   	P: -39.12139 22.23130 28.19957 -82.765 -74.137 -39.330	2025-09-19 15:40:41 	ABSACC
195       	警       	用户                  	80002   	P: 46.76137 12.70794 12.57868 34.078 -20.818 -109.699	2025-09-19 15:40:43 	ABSACC
196       	警       	用户                  	80002   	P: -35.58897 35.84398 3.59750 -83.645 -70.352 -28.208	2025-09-19 15:40:46 	ABSACC
197       	警       	用户                  	80002   	P: -33.69743 15.05098 7.40514 -89.200 -67.611 -10.108	2025-09-19 15:40:47 	ABSACC
198       	警       	用户                  	80002   	P: 45.60012 15.14767 5.50915 39.325 -16.467 -115.702	2025-09-19 15:40:49 	ABSACC
199       	警       	用户                  	80002   	P: 47.38248 15.59384 13.65335 30.387 -24.452 -105.388	2025-09-19 15:40:50 	ABSACC
200       	警       	用户                  	80002   	P: -36.93308 22.82844 25.97471 -81.488 -72.511 -37.864	2025-09-19 15:40:52 	ABSACC
201       	警       	用户                  	80002   	P: 54.69347 12.50518 8.11787 -301.643 -22.905 -132.440	2025-09-19 15:40:55 	ABSACC
202       	警       	用户                  	80002   	P: 52.03054 21.24503 26.18675 25.265 -42.279 -95.891	2025-09-19 15:40:57 	ABSACC
203       	警       	用户                  	80002   	P: -33.63757 20.34934 16.39825 -83.387 -68.532 -25.515	2025-09-19 15:40:59 	ABSACC
204       	警       	用户                  	80002   	P: 23.45809 16.09031 27.50879 -19.347 -37.382 -64.938	2025-09-19 15:41:01 	ABSACC
205       	警       	用户                  	80002   	P: 29.58099 22.82531 16.40473 -10.504 -31.969 -70.754	2025-09-19 15:41:02 	ABSACC
206       	警       	用户                  	80002   	P: -22.99001 49.31914 -13.33747 -76.710 -59.954 -26.335	2025-09-19 15:41:04 	ABSACC
207       	警       	用户                  	80002   	P: 19.66382 19.82106 0.14375 -52.851 -19.413 -29.848	2025-09-19 15:41:05 	ABSACC
208       	警       	用户                  	80002   	P: 28.91830 13.72494 24.37543 -12.128 -30.958 -69.336	2025-09-19 15:41:06 	ABSACC
209       	警       	用户                  	80002   	P: -42.09590 4.78221 26.29380 -90.094 -75.208 -19.155	2025-09-19 15:41:08 	ABSACC
210       	警       	用户                  	80002   	P: -38.66962 14.42019 4.32558 -92.264 -72.326 -6.250	2025-09-19 15:41:09 	ABSACC
211       	警       	用户                  	80002   	P: 28.15139 10.37581 5.72761 -39.934 -10.889 -40.463	2025-09-19 15:41:11 	ABSACC
212       	警       	用户                  	80002   	P: 25.06065 18.43706 -1.23181 -47.275 -13.761 -33.867	2025-09-19 15:41:11 	ABSACC
213       	警       	用户                  	80002   	P: 34.08546 37.91673 5.31545 -1.889 -35.598 -77.540	2025-09-19 15:41:12 	ABSACC
214       	警       	用户                  	80002   	P: 38.89183 34.29600 -6.85994 10.803 -20.065 -88.609	2025-09-19 15:41:13 	ABSACC
215       	警       	用户                  	80002   	P: -42.86027 12.19914 38.09492 -85.723 -76.494 -38.946	2025-09-19 15:41:16 	ABSACC
216       	警       	用户                  	80002   	P: 52.07943 12.28195 9.41570 51.815 -21.516 -126.422	2025-09-19 15:41:18 	ABSACC
217       	警       	用户                  	80002   	P: 25.19256 33.18970 10.74046 -16.517 -37.322 -67.019	2025-09-19 15:41:20 	ABSACC
218       	警       	用户                  	80002   	P: 33.39997 23.17897 -0.82079 -6.900 -14.776 -72.504	2025-09-19 15:41:20 	ABSACC
219       	警       	用户                  	80002   	P: 28.11121 19.77313 3.35417 -24.884 -16.911 -55.971	2025-09-19 15:41:21 	ABSACC
220       	警       	用户                  	80002   	P: 19.22199 9.61920 5.26038 -67.028 -17.229 -15.063	2025-09-19 15:41:21 	ABSACC
221       	警       	用户                  	80002   	P: 20.67166 16.47174 11.99358 -36.147 -24.924 -47.391	2025-09-19 15:41:22 	ABSACC
222       	警       	用户                  	80002   	P: -41.46207 -8.62005 20.38990 -94.973 -75.471 0.830	2025-09-19 15:41:24 	ABSACC
223       	警       	用户                  	80002   	P: -38.29674 18.38717 10.53281 -88.817 -71.890 -16.955	2025-09-19 15:41:25 	ABSACC
224       	警       	用户                  	80002   	P: -44.53110 10.49003 28.34546 -89.587 -77.214 -27.140	2025-09-19 15:41:25 	ABSACC
225       	警       	用户                  	80002   	P: -37.64280 17.55789 15.49023 -87.097 -71.456 -21.317	2025-09-19 15:41:26 	ABSACC
226       	警       	用户                  	80002   	P: 49.01360 46.17852 -11.66873 28.603 -29.741 -102.408	2025-09-19 15:41:29 	ABSACC
227       	警       	用户                  	80002   	P: 22.74184 22.91816 11.05354 -26.427 -28.712 -57.085	2025-09-19 15:41:30 	ABSACC
228       	警       	用户                  	80002   	P: -34.90295 18.51693 9.95813 -87.311 -68.897 -16.581	2025-09-19 15:41:32 	ABSACC
229       	警       	用户                  	80002   	P: -32.44954 4.29038 10.25990 -92.150 -66.517 -1.518	2025-09-19 15:41:32 	ABSACC
230       	警       	用户                  	80002   	P: -36.18123 6.95369 19.29117 -88.761 -69.952 -14.156	2025-09-19 15:41:33 	ABSACC
231       	警       	用户                  	80002   	P: 30.70912 -9.48051 17.83201 -81.537 -4.482 1.963	2025-09-19 15:41:35 	ABSACC
232       	警       	用户                  	80002   	P: -29.09245 30.96095 -2.19238 -84.251 -63.857 -17.303	2025-09-19 15:41:37 	ABSACC
233       	警       	用户                  	80002   	P: 30.16761 13.45692 13.72790 -14.556 -20.102 -65.913	2025-09-19 15:41:39 	ABSACC
234       	警       	用户                  	80002   	P: 34.17666 5.75124 26.87636 -2.369 -24.987 -76.944	2025-09-19 15:41:39 	ABSACC
235       	警       	用户                  	80002   	P: 33.67743 21.92493 4.19711 -4.758 -18.529 -74.636	2025-09-19 15:41:40 	ABSACC
236       	警       	用户                  	80002   	P: 18.44905 15.56858 10.59158 -43.716 -24.423 -40.209	2025-09-19 15:41:41 	ABSACC
237       	警       	用户                  	80002   	P: -47.74786 0.22759 11.47016 -96.133 -81.604 0.276	2025-09-19 15:41:43 	ABSACC
238       	警       	用户                  	80002   	P: 31.11163 -4.42893 40.41226 -8.446 -28.570 -72.052	2025-09-19 15:41:45 	ABSACC
239       	警       	用户                  	80002   	P: -35.44413 31.49348 -10.51122 -90.419 -69.260 -8.555	2025-09-19 15:41:47 	ABSACC
240       	警       	用户                  	80002   	P: 22.63840 37.65105 -5.65779 -28.272 -26.983 -55.025	2025-09-19 15:41:49 	ABSACC
241       	警       	用户                  	80002   	P: -36.95478 13.80166 4.08938 -92.043 -70.751 -5.282	2025-09-19 15:41:52 	ABSACC
242       	警       	用户                  	80002   	P: -41.14545 1.33653 34.65072 -88.233 -74.462 -24.260	2025-09-19 15:41:52 	ABSACC
243       	警       	用户                  	80002   	P: -28.14341 29.47462 16.69558 -75.520 -66.152 -36.372	2025-09-19 15:41:53 	ABSACC
244       	警       	用户                  	80002   	P: 49.07078 9.12244 22.83027 31.014 -27.520 -105.125	2025-09-19 15:41:56 	ABSACC
245       	警       	用户                  	80002   	P: 45.46648 7.93326 15.12726 34.261 -18.281 -110.451	2025-09-19 15:41:56 	ABSACC
246       	警       	用户                  	80002   	P: 17.42604 44.42091 -5.18165 -31.488 -35.398 -54.862	2025-09-19 15:41:57 	ABSACC
247       	警       	用户                  	80002   	P: -37.16018 23.67735 14.04879 -85.267 -71.402 -26.243	2025-09-19 15:41:59 	ABSACC
248       	警       	用户                  	80002   	P: 33.57243 -4.42032 38.16907 -3.598 -26.126 -75.918	2025-09-19 15:42:01 	ABSACC
249       	警       	用户                  	80002   	P: 38.48728 30.79434 6.57132 6.572 -29.867 -84.208	2025-09-19 15:42:02 	ABSACC
250       	警       	用户                  	80002   	P: 19.42770 28.81735 12.48380 -26.995 -36.450 -58.818	2025-09-19 15:42:03 	ABSACC
251       	警       	用户                  	80002   	P: 40.92387 1.48530 10.05093 56.265 -6.855 -134.250	2025-09-19 15:42:04 	ABSACC
252       	警       	用户                  	80002   	P: 31.51031 31.04385 6.45795 -7.306 -30.046 -73.104	2025-09-19 15:42:05 	ABSACC
253       	警       	用户                  	80002   	P: -38.37885 -1.77311 27.98873 -89.750 -71.933 -14.077	2025-09-19 15:42:08 	ABSACC
254       	警       	用户                  	80002   	P: 37.06097 -5.11908 45.53639 3.421 -32.810 -81.567	2025-09-19 15:42:10 	ABSACC
255       	警       	用户                  	80002   	P: -38.98899 -5.87044 32.07030 -90.023 -72.473 -14.077	2025-09-19 15:42:11 	ABSACC
256       	警       	用户                  	80002   	P: -32.26995 37.90245 -13.63582 -87.821 -66.343 -12.149	2025-09-19 15:42:12 	ABSACC
257       	警       	用户                  	80002   	P: 55.53862 21.03292 -4.54624 -291.467 -21.768 216.835	2025-09-19 15:42:16 	ABSACC
258       	警       	用户                  	80002   	P: -45.59096 4.75680 24.63547 -92.266 -78.258 -17.476	2025-09-19 15:42:19 	ABSACC
259       	警       	用户                  	80002   	P: -36.78839 29.96986 2.01543 -86.990 -70.675 -20.236	2025-09-19 15:42:19 	ABSACC
260       	警       	用户                  	80002   	P: 29.12599 35.84350 -2.20606 -13.478 -26.583 -67.648	2025-09-19 15:42:22 	ABSACC
261       	警       	用户                  	80002   	P: -25.59511 37.18214 -2.60318 -79.221 -61.730 -24.259	2025-09-19 15:42:24 	ABSACC
262       	警       	用户                  	80002   	P: -39.52353 17.65732 16.56883 -87.798 -73.088 -22.463	2025-09-19 15:42:25 	ABSACC
263       	警       	用户                  	80002   	P: 31.85528 28.63312 -2.89090 -10.433 -18.359 -69.476	2025-09-19 15:42:27 	ABSACC
264       	警       	用户                  	80002   	P: 21.25920 10.75614 28.13562 -25.522 -33.652 -59.158	2025-09-19 15:42:28 	ABSACC
265       	警       	用户                  	80002   	P: -26.71343 26.99969 2.20605 -82.745 -61.837 -18.058	2025-09-19 15:42:30 	ABSACC
266       	警       	用户                  	80002   	P: 16.66934 27.99598 9.07958 -34.334 -33.884 -51.945	2025-09-19 15:42:31 	ABSACC
267       	警       	用户                  	80002   	P: 20.57969 42.54556 -2.79701 -26.061 -34.669 -59.017	2025-09-19 15:42:32 	ABSACC
268       	警       	用户                  	80002   	P: 27.82272 -6.20171 36.55704 -18.429 -23.718 -62.969	2025-09-19 15:42:33 	ABSACC
269       	警       	用户                  	80002   	P: 26.15264 -2.29462 15.43388 -59.272 -10.436 -21.312	2025-09-19 15:42:34 	ABSACC
270       	警       	用户                  	80002   	P: 39.62564 18.74338 7.01408 13.924 -18.601 -91.578	2025-09-19 15:42:34 	ABSACC
271       	警       	用户                  	80002   	P: 41.07637 17.72264 -1.28402 33.912 -10.487 -111.624	2025-09-19 15:42:35 	ABSACC
272       	警       	用户                  	80002   	P: 38.26758 -5.66814 19.67155 25.797 -7.025 -104.172	2025-09-19 15:42:35 	ABSACC
273       	警       	用户                  	80002   	P: 34.22860 41.97461 -8.63271 -2.205 -25.723 -77.098	2025-09-19 15:42:37 	ABSACC
274       	警       	用户                  	80002   	P: 16.13115 32.45883 8.47203 -32.291 -37.355 -54.914	2025-09-19 15:42:38 	ABSACC
275       	警       	用户                  	80002   	P: -35.00648 3.58884 7.36038 -94.123 -69.228 2.211	2025-09-19 15:42:40 	ABSACC
276       	警       	用户                  	80002   	P: 31.86683 11.88346 22.77671 -7.178 -27.179 -73.003	2025-09-19 15:42:42 	ABSACC
277       	警       	用户                  	80002   	P: -35.27682 28.95519 14.41206 -82.047 -70.590 -32.365	2025-09-19 15:42:44 	ABSACC
278       	警       	用户                  	80002   	P: 47.40902 36.30526 -0.11081 24.372 -30.657 -98.579	2025-09-19 15:42:47 	ABSACC
279       	警       	用户                  	80002   	P: 28.50228 -0.26701 24.51270 -22.218 -17.767 -58.588	2025-09-19 15:42:48 	ABSACC
280       	警       	用户                  	80002   	P: 30.59943 19.06643 26.89644 -7.344 -38.525 -73.797	2025-09-19 15:42:48 	ABSACC
281       	警       	用户                  	80002   	P: 39.32487 36.68295 -7.29774 11.000 -22.074 -88.609	2025-09-19 15:42:49 	ABSACC
282       	警       	用户                  	80002   	P: 32.28860 -2.52404 18.88345 -18.466 -9.140 -61.085	2025-09-19 15:42:50 	ABSACC
283       	警       	用户                  	80002   	P: -34.73229 16.89444 12.21576 -86.982 -68.783 -17.265	2025-09-19 15:42:52 	ABSACC
284       	警       	用户                  	80002   	P: 45.83580 25.79242 5.84300 24.788 -25.979 -100.064	2025-09-19 15:42:55 	ABSACC
285       	警       	用户                  	80002   	P: -25.20920 19.47350 -0.69268 -87.906 -59.609 -6.285	2025-09-19 15:42:57 	ABSACC
286       	警       	用户                  	80002   	P: 24.83707 -11.96054 22.98405 -72.682 -10.739 -7.950	2025-09-19 15:42:59 	ABSACC
287       	警       	用户                  	80002   	P: -23.47043 45.82449 -10.37485 -77.335 -60.199 -25.638	2025-09-19 15:43:01 	ABSACC
288       	警       	用户                  	80002   	P: 43.84390 0.57456 23.58809 28.181 -18.478 -104.725	2025-09-19 15:43:04 	ABSACC
289       	警       	用户                  	80002   	P: -38.76610 -12.39376 26.83794 -93.656 -72.649 -1.753	2025-09-19 15:43:06 	ABSACC
290       	警       	用户                  	80002   	P: 45.48083 17.34247 37.24323 13.864 -47.658 -86.992	2025-09-19 15:43:08 	ABSACC
291       	警       	用户                  	80002   	P: 51.67293 41.15520 -10.36973 37.122 -27.792 -110.484	2025-09-19 15:43:09 	ABSACC
292       	警       	用户                  	80002   	P: 36.39312 4.41308 15.75174 5.437 -12.562 -84.099	2025-09-19 15:43:10 	ABSACC
293       	警       	用户                  	80002   	P: -37.38922 6.29151 5.18529 -94.335 -71.520 1.459	2025-09-19 15:43:12 	ABSACC
294       	警       	用户                  	80002   	P: -41.51105 14.59755 31.29229 -85.801 -75.270 -34.494	2025-09-19 15:43:13 	ABSACC
295       	警       	用户                  	80002   	P: 31.12889 30.41402 4.31683 -8.739 -27.321 -71.698	2025-09-19 15:43:16 	ABSACC
296       	警       	用户                  	80002   	P: -30.33945 29.38183 14.47220 -78.229 -67.174 -33.526	2025-09-19 15:43:18 	ABSACC
297       	警       	用户                  	80002   	P: 46.68371 16.51909 8.25759 34.709 -20.360 -110.391	2025-09-19 15:43:20 	ABSACC
298       	警       	用户                  	80002   	P: -32.19289 23.57714 27.91508 -76.771 -70.035 -41.242	2025-09-19 15:43:23 	ABSACC
299       	警       	用户                  	80002   	P: 38.89233 14.32681 7.81418 14.501 -14.929 -92.486	2025-09-19 15:43:25 	ABSACC
300       	警       	用户                  	80002   	P: -27.24656 22.06844 -2.68791 -88.275 -61.547 -6.898	2025-09-19 15:43:27 	ABSACC
301       	警       	用户                  	80002   	P: 41.75780 -9.43904 18.51078 78.337 -6.663 -156.322	2025-09-19 15:43:29 	ABSACC
302       	警       	用户                  	80002   	P: 36.52364 20.91589 17.82135 2.547 -31.112 -80.949	2025-09-19 15:43:31 	ABSACC
303       	警       	用户                  	80002   	P: 41.52564 11.98012 21.23684 14.364 -26.207 -91.033	2025-09-19 15:43:31 	ABSACC
304       	警       	用户                  	80002   	P: 39.45314 43.16298 -8.26796 9.163 -27.524 -86.509	2025-09-19 15:43:32 	ABSACC
305       	警       	用户                  	80002   	P: 22.22516 15.04272 0.37422 -60.085 -14.889 -21.470	2025-09-19 15:43:33 	ABSACC
306       	警       	用户                  	80002   	P: 49.67190 15.77979 5.71910 47.439 -19.675 -122.695	2025-09-19 15:43:34 	ABSACC
307       	警       	用户                  	80002   	P: -42.71286 2.31191 23.20157 -91.814 -75.841 -13.430	2025-09-19 15:43:37 	ABSACC
"""

    # 解析日志数据
    joint_targets = parse_log_data(log_data)

    # 分类关节目标
    categorized_targets = classify_jointtargets(joint_targets)

    # 设置分类到集合名称的映射
    category_to_set = {
        '第四轴正_第五轴正_第六轴正': 'JT_Set1',
        '第四轴正_第五轴正_第六轴负': 'JT_Set1',
        '第四轴正_第五轴负_第六轴正': 'JT_Set1',
        '第四轴正_第五轴负_第六轴负': 'JT_Set1',
        '第四轴负_第五轴正_第六轴正': 'JT_Set1',
        '第四轴负_第五轴正_第六轴负': 'JT_Set1',
        '第四轴负_第五轴负_第六轴正': 'JT_Set1',
        '第四轴负_第五轴负_第六轴负': 'JT_Set1'
    }

    # 格式化输出并保存到文件
    with open("jointtargets_output.txt", "w") as f:
        total_count = 0
        for category, targets in categorized_targets.items():
            if targets and category in category_to_set:  # 只处理有数据且已知的分类
                count = len(targets)
                total_count += count
                set_name = category_to_set[category]

                # 写入分类标题
                f.write(f"// {category} - 共 {count} 个关节目标\n")

                # 格式化并写入关节目标
                formatted_output = format_jointtargets(targets, base_name=set_name)
                for output in formatted_output:
                    f.write(output + "\n")

                f.write("\n")  # 添加空行分隔不同分类

        f.write(f"// 总计 {total_count} 个关节目标\n")

    # 打印分类统计信息
    print("关节目标分类统计:")
    for category, targets in categorized_targets.items():
        if targets and category in category_to_set:
            print(f"{category}: {len(targets)} 个")

    print(f"\n总计 {total_count} 个关节目标已保存到 jointtargets_output.txt")